<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <title>喝思索引擎扬中国文化</title>
    <link rel="stylesheet" href="css/loading.css">
    <script src="js/loading.js"></script>
    <link rel="stylesheet" href="css/public.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/popup.css">
</head>
<body>
<header class="home-header">
    <img src="images/home_bg.jpg" alt="加载中">
</header>
<section class="body padding">
    <!--开桌-->
    <div class="create-game">
        <h2 class="none text-center color-white">开桌</h2>
        <form action="">
            <div class="flex flex-vc create-game-form">
                <div class="">桌号</div>
                <div class="box-flex-1"><strong class="color-yellow create-tab-num " style="margin-right: .3rem">05</strong>号</div>
            </div>
            <div class="flex flex-vc create-game-form">
                <div class="">密码</div>
                <div class="box-flex-1">
                    <input type="password" name="password" class="inp inp-block create-tab-password">
                </div>
            </div>
            <div class="flex flex-vc create-game-form">
                <div class="">人数</div>
                <div class="box-flex-1">
                    <select  class="" name="gamePeopleNum">
                        <option value="2">2人</option>
                        <option value="3">3人</option>
                        <option value="4">4人</option>
                        <option value="5">5人</option>
                        <option value="6">6人</option>
                        <option value="7">7人</option>
                        <option value="8">8人</option>
                        <option value="9">9人</option>
                        <option value="10">10人</option>
                    </select>
                </div>
            </div>
            <div class="text-center mt1rem btn-submit">
                <button type="button" class="btn btn-yellow btn-create-tab">确认</button>
            </div>
        </form>
    </div>
    <!--选座-->
    <div class="select-game mt05rem">
        <ul class="none flex flex-hw text-center">
            <li class="item tab-item">
                <!--桌号-->
                <div class="color-white tab-num text-center fz2rem" data-people="10" data-pwd="666">
                    <strong>01</strong>
                    <ul class="game-player-item color-white">
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                       <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                         <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                    </ul>
                </div>
            </li>
                        <li class="item tab-item">
                <!--桌号-->
                <div class="color-white tab-num text-center fz2rem" data-people="8" data-pwd="666">
                    <strong>02</strong>
                    <ul class="game-player-item color-white">
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                         <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                      <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                         <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>     
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                    </ul>
                </div>
            </li>
                        <li class="item tab-item">
                <!--桌号-->
                <div class="color-white tab-num text-center fz2rem"  data-people="8" data-pwd="666">
                    <strong>03</strong>
                    <ul class="game-player-item color-white">
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                      <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                       <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                         <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>      
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                          <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                    </ul>
                </div>
            </li>
                        <li class="item tab-item">
                <!--桌号-->
                <div class="color-white tab-num text-center fz2rem" data-people="6" data-pwd="666">
                    <strong>04</strong>
                    <ul class="game-player-item color-white">
                        <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                         <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                      <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                       <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                       <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                         <li class="player-item"><img src="images/headImg.jpg" alt=""></li>
                    </ul>
                </div>
            </li>
        </ul>
    </div>
</section>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/popup.js"></script>
<script>
//动态设置选座的玩家left  top  位置
function setPlayerOffset(){
        var r = $(".tab-item").outerHeight() /2;        //73
        var  $player_item = $(".game-player-item");
    //根据 玩家的数量动态计算出对应的位置
    $player_item.each(function(){
        var $this = $(this),
            $player_item =  $this.find(".player-item"),
            itemWidth = $player_item.outerWidth() /2 ,
            length = $player_item.length;
        for(var i=0,len =length; i<len; i++){
            var x = Math.round( Math.sin((i*(360/length))/180*Math.PI) * r + itemWidth -2);
            var y = Math.round( Math.cos((i*(360/length))/180*Math.PI) * r + itemWidth -2);
            $player_item.eq(i).css({"top":y,"left":x})
        }
    })

}
    $(function(){
        setPlayerOffset();

        var $tab_numBtn = $(".tab-num");          //桌号进入按钮
        //房间号
        //回调 （按钮索引,用户输入的密码）
        //按钮  默认 {'确认':'btn-yellow'}
        $tab_numBtn.on("click",function(){
            var $this = $(this),
                $zoomNumber = $this.find("strong").text(),     //桌号
                $zoomPeopleNum =$this.data("people"),      //这桌有多少人
                $zoomPwd = $this.data("pwd"); //房间密码
            writePopup($zoomNumber,function( index,password ){
                if( index==1 ){
                    if( password == $zoomPwd ){
                        var sessionStorage = window.sessionStorage;
                        sessionStorage.setItem("zoomNumber",$zoomNumber);
                        sessionStorage.setItem("zoomPwd",$zoomPwd);
                        sessionStorage.setItem("zoomPeopleNum",$zoomPeopleNum);
                        window.location.href="game.html"
                    }else{
                        popup("密码错误")
                    }
                }
            })
        });




        //创建房间
        var $btn_create_tab = $(".btn-create-tab");      //创建房间按钮
        $btn_create_tab.on("click",function(){
            var loading;
            var $zoomNumber = $(".create-tab-num").text(),     //房间号
                 $zoomPwd= $(".create-tab-password").val(),      //密码
                $zoomPeopleNum = $("select[name='gamePeopleNum']").val() //人数
            if( $zoomPwd == "" ){
                return popup("请填写房间密码!");
            }
            //模拟 用户创建房间  这里用本地存储模拟接收 房间信息  以便下个页面接收
            if(window.sessionStorage){
                var sessionStorage = window.sessionStorage;
                sessionStorage.setItem("zoomNumber",$zoomNumber);
                sessionStorage.setItem("zoomPwd",$zoomPwd);
                sessionStorage.setItem("zoomPeopleNum",$zoomPeopleNum)
            }else{
                popup('异常');
                return;
            }
            window.location.href = "game.html";
//            $.ajax({
//                url:"",
//                type:"post",
//                data:{num:$tabNum,pwd:$pwd,people:$peopleNum},
//                dataType:"json",
//                cache:false,
//                beforeSend:function(){
//                   loading = new loadingPopup("创建中,请稍后..");
//                },
//                success:function(){
//                    popup("创建成功");
//                    //do..something
//                   loading.delete();
//                },
//                error:function(){
//                    loading.delete();
//                    popup("创建失败!")
//                }
//            })
        })
    })
</script>
</html>